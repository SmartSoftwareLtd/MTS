@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .ui-autocomplete {
        max-height: 100px;
        overflow-y: auto;
        /* prevent horizontal scrollbar */
        overflow-x: hidden;
    }
</style>
<div class="box-body" style="margin-left: 30px;">
    <input type="hidden" id="hdnVehicleID">
    <input type="hidden" id="hdnCutomerTypeID" />
    <input id="strCutomerTypeName" type="hidden" />

    <input type="hidden" id="hdnShowRoomName" />
    <input id="hdnShowRoomNumber" type="hidden" />
    <input type="hidden" id="hdnShowRoomPhoneNo" />
    <input id="hdnBlock" type="hidden" />


    <div class="row">

        <div class="form-group col-xs-4">
            <label>Search By Chassis Number</label>
            <input id="txtChassisNumber" class="form-control ui-autocomplete input-group-lg" type="text" name="ChassisNumber"
                   placeholder="Search By Chassis Number" />
        </div>
        <div class="form-group col-xs-3" style="margin-top: -20px;">
            <label></label>
            <span id="CustomerType" style="background-color: orange;display:none" class='bling form-control input-group-sm'> </span>
        </div>
        <div class="form-group col-xs-3" style="margin-top: -20px;">
            <h3>
                <label id="ParkingInfo" class="label label-warning form-control input-group-lg col-lg" style="display:none">
                    Parking Fee: <span id="lblParkingFees" class="label label-success"></span>
                </label>
            </h3>
        </div>
    </div>
    @*<br />
        <table id="dataGrid" class="table table-bordered table-striped"></table>
        <br />*@
    <div class="row" id="divForFullCustomer" style="display:none">
        <div>
            <h3>
                <label id="VehicleInfo" class="label label-warning form-control input-group-lg col-lg">
                    Chassis No: <span id="spnChassisNo" class="label label-success"></span> - Make: <span id="spnMake" class="label label-success"></span> -
                    Color: <span id="spnColor" class="label label-success"></span> - Year: <span id="spnYear" class="label label-success"></span>- Yard: <span id="spnYard" class="label label-success"></span>
                </label>
            </h3>
        </div>
        <br />
        <div class="row">
            <div class="form-group col-xs-4">
                <label>Date:</label>
                <input id="strCurrentDate" class="form-control datepicker input-group-lg" type="text"
                       placeholder="Enter drop of date..." oninput="calcExpiryDate();" onchange="calcExpiryDate();" />
            </div>
            <div class="form-group col-xs-4">
                <label>D/O Expiry Date:</label>
                <input id="strExpiryDate" class="form-control input-group-lg" type="text"
                       placeholder="Enter drop of date..." readonly />
            </div>
        </div>
        <div class="row">
            <div id="divForDirectCustomer" style="display:none">
                <div class="form-group col-xs-4">
                    <label>Name:</label>
                    <input id="CustomerFullName" class="form-control input-group-lg" type="text"
                           placeholder="Enter Customer Name" />
                </div>

                <div class="form-group col-xs-4">
                    <label>Phone No:</label>
                    <input id="fltPhoneNumber" class="form-control input-group-lg" type="text"
                           placeholder="Enter Phone No" />
                </div>
            </div>
            <div id="divForShowRoomCustomer" style="display:none">
                <div class="form-group col-xs-4">
                    <label>ShowRoom Customer Name:</label>
                    <input id="ShowRoomCustomerName" class="form-control input-group-lg" type="text"
                           placeholder="Enter Customer Name" />
                </div>
                <div class="form-group col-xs-4">
                    <label>ShowRoom Phone No:</label>
                    <input id="strPersonPhoneNo" class="form-control input-group-lg" type="text"
                           placeholder="Enter Phone No" />
                </div>

                <div class="form-group col-xs-4" style="display:none;">
                    <label>CarDelivery Date:</label>
                    <input id="strCarDeliveryDate" class="form-control datepicker input-group-lg" type="text"
                           placeholder="CarDelivery Date" />
                </div>
            </div>
        </div>
    </div>
    <div id="dialog" style="display: none; " align="center">
        Do you want to Save ?
    </div>
    <br />
    <div id="divForAllBtn">
        <div style="margin-left: 222px;">


            <input type="button" style="margin-left: -100px;" class="btn btn-success col-md-1" id="btnSave" value="Save" />
            @*<input type="button" id="btnUpdate" value="Update " />*@
            <input type="button" style="margin-left: -10px; display: none;" class="btn btn-success col-md-2" id="btnPrintMainDO" value="Print Main DO" onclick="generateMainDOPDF()" />

            <input type="button" style="margin-left: -10px; display: none;" class="btn btn-success col-md-3" id="btnPrintTempDO" value="Print Temporary DO" onclick="generateTempDOPDF()" />
            @*<input type="button" style="margin-left: 15px;" class="btn btn-success col-md-2" id="btnPending" value="Pending Bills " />
                <input type="button" style="margin-left: 15px;" class="btn btn-success col-md-2" id="btnExpired" value="Expired Bills " />*@
            <input type="button" style="margin-left: 15px;" class="btn btn-warning col-md-2" value="Back To List" onclick="Cancel();">

        </div>

    </div>

</div>




<script type="text/javascript">



    function Cancel() {
        window.location.href = "/DO/DOList";
    }
    $(function () { // will trigger when the document is ready
        $('.datepicker').datepicker({ dateFormat: 'mm/dd/yy' }); //Initialise any date pickers
        $("#strCurrentDate").datepicker("setDate", new Date());
        calcExpiryDate();
    });


    var arrVehicle = [];
    //var arrSubGridData = [];

    $(function () {
        $("#txtChassisNumber").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '/DO/GetCustomerDetails/',
                    data: "{ 'prefix': '" + request.term + "'}",
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        if (!data.length) {
                            var result = [
                             {
                                 label: 'No matches found',
                                 value: response.term
                             }
                            ];
                            response(result);
                        }
                        else {
                            // normal response
                            response($.map(data, function (item) {
                                return {

                                    iVehicleID: item.iVehicleID,
                                    strChassisNum: item.strChassisNum,
                                    strMake: item.strMake,
                                    iModel: item.iModel,
                                    strColor: item.strColor,
                                    //dmlSellingPrice: item.dmlSellingPrice,
                                    CustomerFullName: item.CustomerFullName,
                                    fltPhoneNumber: item.fltPhoneNumber,//direct cust phn no
                                    ShowRoomCustomerName: item.ShowRoomCustomerName,
                                    strPersonPhoneNo: item.strPersonPhoneNo,//ShowRoom cust phn no

                                    dmlParkingFees: item.dmlParkingFees,

                                    strShowRoomName: item.strShowRoomName,
                                    strShowRoomNumber: item.strShowRoomNumber,
                                    strShowRoomPhoneNo: item.strShowRoomPhoneNo,
                                    strBlock: item.strBlock,
                                    YardName: item.strYardName,

                                    //iInstallment: item.iInstallment,
                                    //TotalReceived: item.TotalReceived,
                                    strCutomerTypeName: item.strCutomerTypeName,
                                    iCutomerTypeID: item.iCutomerTypeID,
                                    value: item.strChassisNum

                                }
                            }));
                        }
                    }


                });
            },
            select: function (event, i) {
                debugger
                event.preventDefault();

                $("#divForFullCustomer").show();
                $("#hdnVehicleID").val(i.item.iVehicleID);
                $("#txtChassisNumber").val(i.item.value);
                $("#CustomerType").show(); $("#ParkingInfo").show();
                $("#hdnCutomerTypeID").val(i.item.iCutomerTypeID);
                $("#CustomerType").text(i.item.strCutomerTypeName);

                if (i.item.dmlParkingFees == null || i.item.dmlParkingFees == 0 ) {
                    $("#lblParkingFees").text("0");
                }
                else {
                    $("#lblParkingFees").text(i.item.dmlParkingFees);
                }
                

                $("#spnChassisNo").html(i.item.value);
                $("#spnMake").html(i.item.strMake);
                $("#spnColor").html(i.item.strColor);
                $("#spnYear").html(i.item.iModel);
                $("#spnYard").html(i.item.YardName);
                
                $("#CustomerFullName").val(i.item.CustomerFullName);
                $("#fltPhoneNumber").val(i.item.fltPhoneNumber);
                $("#ShowRoomCustomerName").val(i.item.ShowRoomCustomerName);
                $("#strPersonPhoneNo").val(i.item.strPersonPhoneNo);


                $("#hdnShowRoomName").val(i.item.strShowRoomName);
                $("#hdnShowRoomNumber").val(i.item.strShowRoomNumber);
                $("#hdnShowRoomPhoneNo").val(i.item.strShowRoomPhoneNo);
                $("#hdnBlock").val(i.item.strBlock);



                if ($("#hdnCutomerTypeID").val() == 1) {
                    $("#divForDirectCustomer").hide();
                    $("#divForShowRoomCustomer").show();

                }
                else
                    if ($("#hdnCutomerTypeID").val() == 2) {
                        $("#divForDirectCustomer").show();
                        $("#divForShowRoomCustomer").hide();

                    }
                //setInterval(function () {
                //    $(".bling").fadeToggle();
                //}, 500);


                //var result = {
                //    iVehicleID: i.item.iVehicleID,
                //    strChassisNum: i.item.strChassisNum,
                //    strMake: i.item.strMake,
                //    iYear: i.item.iYear,
                //    strColor: i.item.strColor,
                //    dmlSellingPrice: i.item.dmlSellingPrice,
                //    CustomerFullName: i.item.CustomerFullName
                //};
                //arrVehicle.push(result);



                //dataGridForVehicle(arrVehicle);
                //arrVehicle = [];

            },
            minLength: 1
        });
    });






    $("#btnSave").click(function () {
        debugger
        $(function () {
            if ($(this).attr("rel") != "update") {
                $('#dialog').dialog('open');
                return false;
            }
        });

        $("#dialog").dialog({
            modal: true,
            autoOpen: false,
            title: "Confirmation",
            width: 350,
            height: 160,
            buttons: [
        {
            id: "Yes",
            text: "Yes",
            click: function () {

                //calling function here for update

                debugger

                var vehicleID = $("#hdnVehicleID").val();
                var currentDate = $("#strCurrentDate").val();
                var ExpiryDate = $("#strExpiryDate").val();

                if ($("#hdnCutomerTypeID").val() == 1) {
                    var custName = $("#ShowRoomCustomerName").val();
                }
                else
                    if ($("#hdnCutomerTypeID").val() == 2) {
                        var custName = $("#CustomerFullName").val();
                    }


                //var DeliveryDate = $("#strCarDeliveryDate").val();

                var doData =
                      {
                          iVehicleID: vehicleID,
                          strCurrentDate: currentDate,
                          strExpiryDate: ExpiryDate,
                          strCustomerName: custName,

                          //dtExpiryDate: ExpiryDate,
                          //dtCurrentDate: currentDate,

                          //strCarDeliveryDate:DeliveryDate

                      }

                //function SaveDOData(doData) {
                debugger;

                $.ajax({
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    type: 'POST',
                    url: "/DO/SaveDeliveryOrder",
                    data: JSON.stringify({ 'doModel': doData }),
                    success: function (data) {
                        alert("Succsesfully Saved DO Data.");


                        if ($("#hdnCutomerTypeID").val() == 1) {


                            $("#btnSave").hide();
                            $("#btnPrintMainDO").hide();
                            $("#btnPrintTempDO").show();
                        }
                        else
                            if ($("#hdnCutomerTypeID").val() == 2) {
                                $("#btnPrintMainDO").show();
                                $("#btnPrintTempDO").hide();
                                $("#btnSave").hide();
                            }
                        //if ($("#hdniCutomerTypeID").val() == 1) {
                        //    $("#btnPrintTempDO").show();
                        //}
                        //else if ($("#hdniCutomerTypeID").val() == 2) {
                        //    $("#btnPrintMainDO").show();
                        //}

                        //$("#btnAdd").hide();

                        //window.location.href = "/Papers/PapersList";
                    }
                });
                //}



                $(this).dialog('close');
            }

        },
        {
            id: "No",
            text: "No",
            click: function () {
                $(this).dialog('close');
            }
        }
            ]
        });







    });

    function calcExpiryDate() {
        var DecDate = $("#strCurrentDate").val();
        var expDate = new Date(DecDate);
        expDate.setDate(expDate.getDate() + 3);

        var date =
         ("0" + (expDate.getMonth() + 1)).slice(-2) + "/" +
         ("0" + expDate.getDate()).slice(-2) + "/" +
         expDate.getFullYear();

        // var date =
        //("0" + expDate.getDate()).slice(-2) + "/" +
        //("0" + (expDate.getMonth() + 1)).slice(-2) + "/" +
        //expDate.getFullYear();

        $("#strExpiryDate").val(date);

    }
</script>

<script>
    function generateMainDOPDF() {

        //var strChassisNumber = $("#txtChassisNumber").val();

        //$.ajax({
        //    contentType: 'application/json; charset=utf-8',
        //    dataType: 'json',
        //    type: 'POST',
        //    url: "/DO/CheckCustomerIsBlockOrNotForDO",
        //    data: JSON.stringify({ 'chassisNum': strChassisNumber }),
        //    success: function (data) {
        //        debugger
        //        if (data.status == true) {
                    var columns = [];
                    var data = [];


                    var Date = $("#strCurrentDate").val();
                    var CustomerName = $("#CustomerFullName").val();
                    var PhoneNum = $("#fltPhoneNumber").val();
                    var ChassisNum = $("#txtChassisNumber").val();
                    var ExpDate = $("#strExpiryDate").val();
                    var YardName = $("#spnYard").html();

                    var doc = new jsPDF("p", "mm", "a4");
                    //var doc = new jsPDF('l', 'mm', [217, 150], '');

                    var totalPagesExp = "{total_pages_count_string}";

                    var pageContent1 = function (data) {
                        // HEADER

                        doc.setFontSize(30);
                        doc.setTextColor(40);
                        doc.setFontStyle('normal');

                        doc.text("DAA MOTORS FZCO", data.settings.margin.left + 35, 20);
                        doc.setFontSize(13);
                        doc.text("MAIN DO", data.settings.margin.left + 70, 30);

                        //doc.setLineWidth(1)
                        doc.text("DATE:", data.settings.margin.left + 0, 40);
                        doc.text(Date, data.settings.margin.left + 13, 40);
                        doc.line(data.settings.margin.left + 0, 41, 200, 41)

                        doc.text("CUSTOMER NAME", data.settings.margin.left + 0, 50);
                        doc.text(":", data.settings.margin.left + 45, 50);
                        doc.text(CustomerName, data.settings.margin.left + 50, 50);
                        //doc.line(data.settings.margin.left + 35, 51, data.settings.margin.left + 70, 51)

                        doc.text("PHONE NO.", data.settings.margin.left + 0, 60);
                        doc.text(":", data.settings.margin.left + 45, 60);
                        doc.text(PhoneNum, data.settings.margin.left + 50, 60);
                        doc.line(data.settings.margin.left + 0, 65, 200, 65)

                        doc.text("D/O ExpiryDate", data.settings.margin.left + 90, 75);
                        doc.text(":", data.settings.margin.left + 135, 75);
                        doc.text(ExpDate, data.settings.margin.left + 140, 75);
                        //doc.line(data.settings.margin.left + 127, 61, data.settings.margin.left + 160, 61)

                        doc.text("CHASSIS NO.", data.settings.margin.left + 0, 75); 
                        doc.text(":", data.settings.margin.left + 45, 75);
                        doc.text(ChassisNum, data.settings.margin.left + 50, 75);

                        doc.text("YARD", data.settings.margin.left + 0, 85); 
                        doc.text(":", data.settings.margin.left + 45, 85);
                        doc.text(YardName, data.settings.margin.left + 50, 85);

                        doc.line(data.settings.margin.left + 0, 90, 200, 90)
                        // last line
                        doc.line(data.settings.margin.left + 0, 100, 200, 100)

                        doc.setFont('helvetica');
                        doc.setFontType('bold');

                        doc.text("Receiver Sign & Mobile No:", data.settings.margin.left + 0, 85);
                        doc.setLineWidth(1);
                        doc.setDrawColor(0, 0, 0);
                        //doc.line(15, 95, 45, 95);
                        //doc.text("(Mob:", 45, 95); doc.text(")", 90, 95);
                        doc.text("Mob:", data.settings.margin.left + 0, 95);
                        doc.text("Sign.", 140, 95);
                        doc.line(150, 95, 180, 95);


                        doc.setFont('courier');
                        doc.setFontType('bolditalic');

                        doc.text("Terms & Conditions:", data.settings.margin.left + 0, 105);

                        doc.text("1)", data.settings.margin.left + 0, 113);
                        doc.text("PLEASE TAKE THIS DELIVERY WITHIN 02 DAYS FROM THIS DO ISSUE DATE", data.settings.margin.left + 8, 113);
                        doc.text("OTHERWISE THIS DO WILL BE CONSIDERED 'CANCELLED'AND", data.settings.margin.left + 8, 118);
                        doc.text("CUSTOMER HAVE TO PAY AED10 FOR DUPLICATE DO.", data.settings.margin.left + 8, 123);

                        doc.text("------------------------------------------------------------------", data.settings.margin.left + 0, 130);


                        //// FOOTER
                        //var str = "Page " + data.pageCount;
                        //// Total page number plugin only available in jspdf v1.0+
                        //if (typeof doc.putTotalPages === 'function') {
                        //    str = str + " of " + totalPagesExp;
                        //}
                        //doc.setFontSize(10);
                        //doc.text(str, data.settings.margin.left, doc.internal.pageSize.height - 10);

                        //doc.text('Note: This is computer generated ', data.settings.margin.left, 20);
                    };


                    var pageContent2 = function (data) {
                        // HEADER
                        doc.setFont('helvetica');
                        doc.setFontSize(30);
                        doc.setTextColor(40);
                        doc.setFontStyle('normal');

                        doc.text("DAA MOTORS FZCO", data.settings.margin.left + 35, 150);
                        doc.setFontSize(13);
                        doc.text("MAIN DO", data.settings.margin.left + 70, 160);

                        //doc.setLineWidth(1)
                        doc.text("DATE:", data.settings.margin.left + 0, 170);
                        doc.text(Date, data.settings.margin.left + 13, 170);
                        doc.line(data.settings.margin.left + 0, 172, 200, 172)

                        doc.text("CUSTOMER NAME", data.settings.margin.left + 0, 180);
                        doc.text(":", data.settings.margin.left + 45, 180);
                        doc.text(CustomerName, data.settings.margin.left + 50, 180);
                        //doc.line(data.settings.margin.left + 35, 51, data.settings.margin.left + 70, 51)

                        doc.text("PHONE NO.", data.settings.margin.left + 0, 190);
                        doc.text(":", data.settings.margin.left + 45, 190);
                        doc.text(PhoneNum, data.settings.margin.left + 50, 190);
                        doc.line(data.settings.margin.left + 0, 192, 200, 192)

                        doc.text("D/O ExpiryDate", data.settings.margin.left + 90, 200);
                        doc.text(":", data.settings.margin.left + 135, 200);
                        doc.text(ExpDate, data.settings.margin.left + 140, 200);
                        //doc.line(data.settings.margin.left + 127, 61, data.settings.margin.left + 160, 61)

                        doc.text("CHASSIS NO.", data.settings.margin.left + 0, 200);
                        doc.text(":", data.settings.margin.left + 45, 200);
                        doc.text(ChassisNum, data.settings.margin.left + 50, 200);

                        doc.text("YARD", data.settings.margin.left + 0, 210);
                        doc.text(":", data.settings.margin.left + 45, 210);
                        doc.text(YardName, data.settings.margin.left + 50, 210);

                        doc.line(data.settings.margin.left + 0, 212, 200, 222)
                        // last line
                        doc.line(data.settings.margin.left + 0, 230, 200, 230)

                        doc.setFont('helvetica');
                        doc.setFontType('bold');

                        doc.text("Receiver Sign & Mobile No:", data.settings.margin.left + 0, 217);
                        doc.setLineWidth(1);
                        doc.setDrawColor(0, 0, 0);
                        //doc.line(15, 95, 45, 95);
                        //doc.text("(Mob:", 45, 95); doc.text(")", 90, 95);
                        doc.text("Mob:", data.settings.margin.left + 0, 227);
                        doc.text("Sign.", 140, 227);
                        doc.line(150, 227, 180, 227);


                        doc.setFont('courier');
                        doc.setFontType('bolditalic');

                        doc.text("Terms & Conditions:", data.settings.margin.left + 0, 237);

                        doc.text("1)", data.settings.margin.left + 0, 245);
                        doc.text("PLEASE TAKE THIS DELIVERY WITHIN 02 DAYS FROM THIS DO ISSUE DATE", data.settings.margin.left + 8, 245);
                        doc.text("OTHERWISE THIS DO WILL BE CONSIDERED 'CANCELLED'AND", data.settings.margin.left + 8, 250);
                        doc.text("CUSTOMER HAVE TO PAY AED10 FOR DUPLICATE DO.", data.settings.margin.left + 8, 255);




                        //// FOOTER
                        //var str = "Page " + data.pageCount;
                        //// Total page number plugin only available in jspdf v1.0+
                        //if (typeof doc.putTotalPages === 'function') {
                        //    str = str + " of " + totalPagesExp;
                        //}
                        //doc.setFontSize(10);
                        //doc.text(str, data.settings.margin.left, doc.internal.pageSize.height - 10);

                        //doc.text('Note: This is computer generated ', data.settings.margin.left, 20);
                    };

                    doc.autoTable(columns, data, {
                        //theme: 'grid',
                        addPageContent: pageContent1,
                        margin: { top: 30 },

                    });

                    doc.autoTable(columns, data, {
                        //theme: 'grid',
                        addPageContent: pageContent2,
                        margin: { top: 100 },

                    });

                    // Total page number plugin only available in jspdf v1.0+
                    if (typeof doc.putTotalPages === 'function') {
                        doc.putTotalPages(totalPagesExp);
                    }
                    //doc.output("dataurlnewwindow");
                    ////doc.output("dataurlnewwindow");
                    window.open(doc.output('bloburl'), '_blank');
                    window.location.href = "/DO/DOList";
                //}
        //    }
        //});
    }


    function generateTempDOPDF() {
        debugger
        //var strChassisNumber = $("#txtChassisNumber").val();

        //$.ajax({
        //    contentType: 'application/json; charset=utf-8',
        //    dataType: 'json',
        //    type: 'POST',
        //    url: "/DO/CheckCustomerIsBlockOrNotForDO",
        //    data: JSON.stringify({ 'chassisNum': strChassisNumber }),
        //    success: function (data) {
        //        debugger
        //        if (data.status == true) {
                    var columns = [];
                    var data = [];



                    var Date = $("#strCurrentDate").val();

                    var ShowRoomName = $("#hdnShowRoomName").val();
                    var ShowRoomNumber = $("#hdnShowRoomNumber").val();
                    var ShowRoomPhoneNo = $("#hdnShowRoomPhoneNo").val();
                    var Block = $("#hdnBlock").val();
                    var PersonPhoneNo = $("#strPersonPhoneNo").val();
                    var PersonFullName = $("#ShowRoomCustomerName").val();
                    var ExpDate = $("#strExpiryDate").val();

                    var ChassisNum = $("#txtChassisNumber").val();
                    var YardName = $("#spnYard").html();

                    //data.push(['DATE:', Date]);
                    //data.push(['SHOWROOM NAME:', ShowRoomName]);
                    //data.push(['SHOWROOM NO:', ShowRoomNumber]);
                    //data.push(['BLOCK NO:', Block]);
                    //data.push(['PHONE NO:', '']);
                    //data.push(['PREP. NAME:', PersonFullName]);
                    //data.push(['PREP. MOB:', PersonPhoneNo]);
                    //data.push(['DATE OF DELIVERY:', '']);
                    //data.push(['CHASSIS NO:', ChassisNum]);
                    var doc = new jsPDF("p", "mm", "a4");
                    //var doc = new jsPDF('l', 'mm', [217, 150], '');

                    var totalPagesExp = "{total_pages_count_string}";

                    var pageContent1 = function (data) {
                        // HEADER

                        doc.setFontSize(30);
                        doc.setTextColor(40);
                        doc.setFontStyle('normal');

                        doc.text("DAA MOTORS FZCO", data.settings.margin.left + 35, 20);
                        doc.setFontSize(13);
                        doc.text("TEMPORARY DO", data.settings.margin.left + 70, 30);

                        //doc.setLineWidth(1)
                        doc.text("DATE:", data.settings.margin.left + 0, 40);
                        doc.text(Date, data.settings.margin.left + 13, 40);
                        doc.line(data.settings.margin.left + 0, 41, 200, 41);

                        doc.text("SHOWROOM NO", data.settings.margin.left + 0, 50);
                        doc.text(":", data.settings.margin.left + 45, 50);
                        doc.text(ShowRoomNumber, data.settings.margin.left + 50, 50);
                        //doc.line(data.settings.margin.left + 32, 61, data.settings.margin.left + 70, 61)

                        doc.text("SHOWROOM NAME", data.settings.margin.left + 70, 50);
                        doc.text(":", data.settings.margin.left + 115, 50);
                        doc.text(ShowRoomName, data.settings.margin.left + 120, 50);
                        //doc.line(data.settings.margin.left + 0, 51, 200, 51)




                        doc.text("BLOCK NO", data.settings.margin.left + 0, 60);
                        doc.text(":", data.settings.margin.left + 45, 60);
                        doc.text(Block, data.settings.margin.left + 50, 60);
                        //doc.line(data.settings.margin.left + 32, 61, data.settings.margin.left + 70, 61)

                        doc.text("PHONE NO", data.settings.margin.left + 70, 60);
                        doc.text(":", data.settings.margin.left + 115, 60);
                        doc.text(ShowRoomPhoneNo, data.settings.margin.left + 120, 60);
                        doc.line(data.settings.margin.left + 0, 65, 200, 65)

                        doc.text("REP. NAME:", data.settings.margin.left + 0, 80);
                        doc.text(":", data.settings.margin.left + 45, 80);
                        doc.text(PersonFullName, data.settings.margin.left + 50, 80);
                        //doc.line(data.settings.margin.left + 32, 61, data.settings.margin.left + 70, 61)

                        doc.text("REP. MOB:", data.settings.margin.left + 0, 90);
                        doc.text(":", data.settings.margin.left + 45, 90);
                        doc.text(PersonPhoneNo, data.settings.margin.left + 50, 90);
                        //doc.line(data.settings.margin.left + 32, 61, data.settings.margin.left + 70, 61)

                        doc.text("D/O ExpiryDate", data.settings.margin.left + 90, 100);
                        doc.text(":", data.settings.margin.left + 135, 100);
                        doc.text(ExpDate, data.settings.margin.left + 140, 100);
                        //doc.line(data.settings.margin.left + 127, 61, data.settings.margin.left + 160, 61)

                        doc.text("CHASSIS NO:", data.settings.margin.left + 0, 100);
                        doc.text(":", data.settings.margin.left + 45, 100);
                        doc.text(ChassisNum, data.settings.margin.left + 50, 100);
                       

                        doc.text("YARD", data.settings.margin.left + 0, 110);
                        doc.text(":", data.settings.margin.left + 45, 110);
                        doc.text(YardName, data.settings.margin.left + 50, 110);

                        doc.line(data.settings.margin.left + 0, 112, 200, 112);

                        doc.setFont('courier');
                        doc.setFontType('bolditalic');
                        doc.text('TERMS & CONDITIONS:', data.settings.margin.left + 0, 120);
                        doc.text('I.  BALANCE WILL BE CLEARED WITHIN    DAYS.', data.settings.margin.left + 0, 125);
                        doc.text('II.  INCASE OF FALURE TO CLEAR DUES WITHIN SPECIFIED PERIOD', data.settings.margin.left + 0, 130);
                        doc.text('THE TEMPORARY D.O WILL BE CANCELED & THE CUSTOMER', data.settings.margin.left + 0, 135);
                        doc.text('HAVE TO RETURN THE VEHICLE IMMEDIATELY OR FACE PENALTIES.', data.settings.margin.left + 0, 140);
                        doc.text('III. PERMANENT D.O WILL BE ISSUED AFTER ALL PAYMENTS CLEARED.', data.settings.margin.left + 0, 145);

                        doc.text('------------------------------------------------------------------', data.settings.margin.left + 0, 150);

                    };

                    //second copy
                    var pageContent2 = function (data) {
                        // HEADER

                        doc.setFont('helvetica');
                        doc.setFontSize(30);
                        doc.setTextColor(40);
                        doc.setFontStyle('normal');

                        doc.text("DAA MOTORS FZCO", data.settings.margin.left + 35, 170);
                        doc.setFontSize(13);
                        doc.text("TEMPORARY DO", data.settings.margin.left + 70, 180);

                        //doc.setLineWidth(1)
                        doc.text("DATE:", data.settings.margin.left + 0, 190);
                        doc.text(Date, data.settings.margin.left + 13, 190);
                        doc.line(data.settings.margin.left + 0, 192, 200, 192);

                        doc.text("SHOWROOM NO", data.settings.margin.left + 0, 200);
                        doc.text(":", data.settings.margin.left + 45, 200);
                        doc.text(ShowRoomNumber, data.settings.margin.left + 50, 200);
                        //doc.line(data.settings.margin.left + 32, 61, data.settings.margin.left + 70, 61)

                        doc.text("SHOWROOM NAME", data.settings.margin.left + 70, 200);
                        doc.text(":", data.settings.margin.left + 115, 200);
                        doc.text(ShowRoomName, data.settings.margin.left + 120, 200);
                        //doc.line(data.settings.margin.left + 0, 51, 200, 51)




                        doc.text("BLOCK NO", data.settings.margin.left + 0, 210);
                        doc.text(":", data.settings.margin.left + 45, 210);
                        doc.text(Block, data.settings.margin.left + 50, 210);
                        //doc.line(data.settings.margin.left + 32, 61, data.settings.margin.left + 70, 61)

                        doc.text("PHONE NO", data.settings.margin.left + 70, 210);
                        doc.text(":", data.settings.margin.left + 115, 210);
                        doc.text(ShowRoomPhoneNo, data.settings.margin.left + 120, 210);
                        doc.line(data.settings.margin.left + 0, 215, 200, 215)

                        doc.text("REP. NAME:", data.settings.margin.left + 0, 230);
                        doc.text(":", data.settings.margin.left + 45, 230);
                        doc.text(PersonFullName, data.settings.margin.left + 50, 230);
                        //doc.line(data.settings.margin.left + 32, 61, data.settings.margin.left + 70, 61)

                        doc.text("REP. MOB:", data.settings.margin.left + 0, 240);
                        doc.text(":", data.settings.margin.left + 45, 240);
                        doc.text(PersonPhoneNo, data.settings.margin.left + 50, 240);
                        //doc.line(data.settings.margin.left + 32, 61, data.settings.margin.left + 70, 61)

                        doc.text("D/O ExpiryDate", data.settings.margin.left + 90, 250);
                        doc.text(":", data.settings.margin.left + 135, 250);
                        doc.text(ExpDate, data.settings.margin.left + 140, 250);
                        //doc.line(data.settings.margin.left + 127, 61, data.settings.margin.left + 160, 61)

                        doc.text("CHASSIS NO:", data.settings.margin.left + 0, 250);
                        doc.text(":", data.settings.margin.left + 45, 250);
                        doc.text(ChassisNum, data.settings.margin.left + 50, 250);

                        doc.text("YARD", data.settings.margin.left + 0, 260);
                        doc.text(":", data.settings.margin.left + 45, 260);
                        doc.text(YardName, data.settings.margin.left + 50, 260);

                        doc.line(data.settings.margin.left + 0, 265, 200, 265);

                        

                        doc.setFont('courier');
                        doc.setFontType('bolditalic');
                        doc.text('TERMS & CONDITIONS:', data.settings.margin.left + 0, 270);
                        doc.text('I.  BALANCE WILL BE CLEARED WITHIN    DAYS.', data.settings.margin.left + 0, 275);
                        doc.text('II.  INCASE OF FALURE TO CLEAR DUES WITHIN SPECIFIED PERIOD', data.settings.margin.left + 0, 280);
                        doc.text('THE TEMPORARY D.O WILL BE CANCELED & THE CUSTOMER', data.settings.margin.left + 0, 285);
                        doc.text('HAVE TO RETURN THE VEHICLE IMMEDIATELY OR FACE PENALTIES.', data.settings.margin.left + 0, 290);
                        doc.text('III. PERMANENT D.O WILL BE ISSUED AFTER ALL PAYMENTS CLEARED.', data.settings.margin.left + 0, 295);
                        //doc.line(data.settings.margin.left + 10, 71, data.settings.margin.left + 40, 71)

                        //doc.setFont('helvetica');
                        //doc.setFontType('bold');

                        //doc.text("Receiver Sign & Mobile No:", data.settings.margin.left + 0, 85);
                        //doc.setLineWidth(1);
                        //doc.setDrawColor(0, 0, 0);
                        //doc.line(15, 95, 45, 95);
                        //doc.text("(Mob:", 45, 95); doc.text(")", 90, 95);



                        //doc.text("Terms & Conditions:", data.settings.margin.left + 0, 105);

                        //doc.setFont('courier');
                        //doc.setFontType('bolditalic');
                        //doc.text("1)", data.settings.margin.left + 0, 113);
                        //doc.text("PLEASE TAKE THIS DELIVERY WITHIN 02 DAYS FROM THIS DO ISSUE DATE", data.settings.margin.left + 8, 113);
                        //doc.text("OTHERWISE THIS DO WILL BE CONSIDERED 'CANCELLED'AND", data.settings.margin.left + 8, 118);
                        //doc.text("CUSTOMER HAVE TO PAY AED10 FOR DUPLICATE DO.", data.settings.margin.left + 8, 123);




                        //// FOOTER
                        //var str = "Page " + data.pageCount;
                        //// Total page number plugin only available in jspdf v1.0+
                        //if (typeof doc.putTotalPages === 'function') {
                        //    str = str + " of " + totalPagesExp;
                        //}
                        //doc.setFontSize(10);
                        //doc.text(str, data.settings.margin.left, doc.internal.pageSize.height - 10);

                        //doc.text('Note: This is computer generated ', data.settings.margin.left, 20);
                    };

                    doc.autoTable(columns, data, {
                        //theme: 'gridWithNoHeader',
                        addPageContent: pageContent1,
                        margin: { top: 30 },

                    });

                    doc.autoTable(columns, data, {
                        //theme: 'gridWithNoHeader',
                        addPageContent: pageContent2,
                        margin: { top: 30 },

                    });

                    // Total page number plugin only available in jspdf v1.0+
                    if (typeof doc.putTotalPages === 'function') {
                        doc.putTotalPages(totalPagesExp);
                    }
                    //doc.output("dataurlnewwindow");
                    ////doc.output("dataurlnewwindow");
                    window.open(doc.output('bloburl'), '_blank');
                    //window.open(doc.output('bloburl'), '_blank');
                    window.location.href = "/DO/DOList";
        //        }
        //    }
        //});
    }

</script>

<!-- JqGrid Scripts -->
<link href="~/scripts/jquery-ui-1.9.2.custom.css" rel="stylesheet" />
<link href="~/scripts/ui.jqgrid.css" rel="stylesheet" />
<script src="~/Scripts/jQuery-migrate-1.2.1-min.js"></script>
<script src="~/scripts/jQuery-migrate-1.2.1.js"></script>
<script src="~/scripts/grid.locale-en.js"></script>
<script src="~/scripts/jquery.jqgrid.min.js"></script>


<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.1/themes/redmond/jquery-ui.css" />

<script src="~/Content/plugins/jsPDF/jspdf.debug.js"></script>
<script src="~/Content/plugins/jsPDF/jspdf.plugin.autotable.js"></script>
<script src="http://www.ittutorials.in/js/demo/numtoword.js" type="text/javascript"></script>